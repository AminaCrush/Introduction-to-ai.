import pandas as pd
import matplotlib.pyplot as plt  # –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ 
from sklearn.cluster import KMeans # –∞–ª–≥–æ—Ä–∏—Ç–º \\ kmeans —Ä–∞–∑–¥–µ–ª—è–µ—Ç –Ω–∞ –≥—Ä—É–ø–ø—ã
from sklearn.preprocessing import StandardScaler # —Å—Ä–µ–¥–Ω–µ–µ = 0, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ = 1

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
data = pd.read_csv("Mall_Customers.csv")
X = data[["Annual Income (k$)", "Spending Score (1-100)"]]

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
num_clusters = 5
# –æ–±—É—á–∞–µ–º
kmeans = KMeans(n_clusters=num_clusters, random_state=42)
clusters = kmeans.fit_predict(X_scaled) # –Ω–∞—Ö–æ–¥–∏—Ç —Ü–µ–Ω—Ç—Ä –∫–ª–∞—Å—Å—Ç–µ—Ä–æ–≤ 

# –∫—Ç–æ –≤ –∫–∞–∫–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.
data["Cluster"] = clusters

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
plt.figure(figsize=(8,6))
for i in range(num_clusters):
    plt.scatter(                            #—Ä–∏—Å—É–µ—Ç —Ç–æ—á–∫–∏ 
        X_scaled[clusters == i, 0],  #   –æ—Å—å X (–≥–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã–π
        X_scaled[clusters == i, 1],  #  –æ—Å—å Y (–æ—Ü–µ–Ω–∫–∞ —Ç—Ä–∞—Ç)
        label=f"–ö–ª–∞—Å—Ç–µ—Ä {i}"
    )
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], c='black', s=200, label='–¶–µ–Ω—Ç—Ä—ã')
plt.title("–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤")
plt.xlabel("–ì–æ–¥–æ–≤–æ–π –¥–æ—Ö–æ–¥ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã–π)")
plt.ylabel("–û—Ü–µ–Ω–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω–∞—è)")
plt.legend()
plt.show()



#plt.legend() ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π —Ü–≤–µ—Ç –∫–∞–∫–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç.
#plt.show() ‚Äî –≤—ã–≤–æ–¥–∏—Ç –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ —ç–∫—Ä–∞–Ω.




#–ö–ª–∞—Å—Ç–µ—Ä 0 (–æ—Ä–∞–Ω–∂–µ–≤—ã–π)
#‚Üí üí∞ –í—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥, –Ω–æ üí≥ –Ω–∏–∑–∫–∏–µ —Ç—Ä–∞—Ç—ã
#–≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –±–µ—Ä–µ–∂–ª–∏–≤—ã–µ –∏–ª–∏ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã.

#–ö–ª–∞—Å—Ç–µ—Ä 1 (–∑–µ–ª—ë–Ω—ã–π)
#‚Üí üí∞ –ù–∏–∑–∫–∏–π –¥–æ—Ö–æ–¥, –Ω–æ üí≥ –≤—ã—Å–æ–∫–∏–µ —Ç—Ä–∞—Ç—ã
#–≠—Ç–æ –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –∏–ª–∏ –º–æ–ª–æ–¥—ã–µ –∫–ª–∏–µ–Ω—Ç—ã.

#–ö–ª–∞—Å—Ç–µ—Ä 2 (–≥–æ–ª—É–±–æ–π)
#‚Üí üí∞ –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –∏ üí≥ —Å—Ä–µ–¥–Ω–∏–µ —Ç—Ä–∞—Ç—ã
#–≠—Ç–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ, —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã.